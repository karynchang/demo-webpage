!function() {
    "use strict";
    new Vue({
      el: "#app",
      data: {
        // gas部署後，複製 "網頁應用程式" 的網址
        gas: "https://script.google.com/macros/s/AKfycbyvWQzcn5Lfus_XB48ROHt-OTtFPiPxMqIG4laosZ2x_Zqpt11irJN3vLdl2xT_7_YD_g/exec",
        name: "",     // 清空name
        phone: "",    // 清空phone
        persons: {},  // 清空persons
        person: {},   // 清空person

        // 報到單頁面點選F12，在元素頁籤中查詢 "<form"，action=後面的那串網址
        formAction: "https://docs.google.com/forms/u/0/d/e/1FAIpQLSfLFQnkyH0pjGjZbFV-dw_O1Z7oAJ9SDgd4lO34BVFLRwi7tA/formResponse",
        
        // 報到單頁面點選F12，在元素頁籤中查詢 "entry."，查詢每個欄位所對應的entry編號
        input: {
          id:'entry.1339314469',          // 報到單表單欄位：ID
          name: 'entry.2132758197',       // 報到單表單欄位：姓名
          gender: 'entry.1833440644',     // 報到單表單欄位：性別
          phone: 'entry.1937240046',      // 報到單表單欄位：電話
          area: 'entry.2050668982',       // 報到單表單欄位：地區
          org_1: 'entry.435100097',       // 報到單表單欄位：系統
          org_2: 'entry.1577594074',      // 報到單表單欄位：(準)支部/法座
          age: 'entry.152815214',         // 報到單表單欄位：年齡
          dept: 'entry.769254',           // 報到單表單欄位：學生部/青年部/一般/幼兒
          join_type: 'entry.1505873101',  // 報到單表單欄位：參加形式
          note: 'entry.1172474453'        // 報到單表單欄位：備註
        },
        loading: !1 //是否顯示loading
      },
      methods: {
        // 電話 最多 10 碼
        limitIdLen(val) {
          if(val.length > 10) {
          return this.phone =  this.phone.slice(0, 10);
          }
        },

        // 送出資料至 報到單 頁籤
        submit: function() {
          var t = this;
          if (void 0 !== this.person.area) {
            var n = ""
              .concat(this.input.id, "=")
              .concat(this.person.id, "&")
              .concat(this.input.name, "=")
              .concat(this.person.name, "&")
              .concat(this.input.gender, "=")
              .concat(this.person.gender, "&")
              .concat(this.input.age, "=")
              .concat(this.person.age, "&")
              .concat(this.input.phone, "=")
              .concat(this.person.phone, "&")
              .concat(this.input.area, "=")
              .concat(this.person.area, "&")
              .concat(this.input.org_1, "=")
              .concat(this.person.org_1, "&")
              .concat(this.input.org_2, "=")
              .concat(this.person.org_2, "&")
              .concat(this.input.dept, "=")
              .concat(this.person.dept, "&")
              .concat(this.input.join_type, "=")
              .concat(this.person.join_type, "&")
              .concat(this.input.note, "=")
              .concat(this.person.note || "");
            // POST到報到單表單，填寫資料
            fetch(this.formAction + "?" + n, { method: "POST" }).catch(function(n) {
              alert("提交成功。"), t.name = "",t.phone="", t.person = {}, t.persons ={};
            });
          }
        }
      },
      watch: {
        // 輸入名字
        name: function(t) {
          var n = this;
          if(this.name.lenth >2 || this.name.length <5)  // 2 < 名字長度 < 5
            if (void 0 === this.persons[this.name]) {
              this.loading = !0; // 是否顯示loading
              var i = this.gas + "?name=" + this.name + "&phone=" + this.phone;  // POS連結
              // POST到GAS查詢資料
              fetch(i, { method: "POST" })
                .then(function(t) {
                  return t.json();
                })
                .then(function(t) {
                  n.persons[n.name] = t, 
                  n.person = t, 
                  n.loading = !1; // 是否顯示loading
                });
              console.log("n.name=",n.name);
              console.log("person=",n.person);
              console.log("persons=",n.persons);
              n.person = {}, n.persons ={};
            } 
            else {
              this.person = this.persons[this.name]; 
            }
        },
        // 輸入電話
        phone: function(t){
          if(t.length <= 10 && t.length >=9){  // 9 <= 電話長度 <= 10
            var n = this;       
            this.loading = !0;
            var i = this.gas + "?name=" + this.name + "&phone=" + this.phone; 
            fetch(i, { method: "POST" })
              .then(function(t) {
                return t.json();
              })
              .then(function(t) {
                n.persons[n.name] = t, n.person = t, n.loading = !1;
              });
            console.log("n.name=",n.name);
            console.log("person=",n.person);
            console.log("persons=",n.persons);
            n.person = {}, n.persons ={};
          }
          else{ 
            this.person = this.persons[this.name]; 

          }
        }
      }
    });
}();
  